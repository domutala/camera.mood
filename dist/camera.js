!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.camera=e():t.camera=e()}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}},function(t,e,i){"use strict";i.r(e),i.d(e,"Camera",(function(){return d}));var n=i(0),a=i.n(n),r=i(1),o=i.n(r),d=function(){function t(e){var i=this,n=e.parent,r=e.facingMode,o=e.className,d=e.delay,u=e.accept,c=e.captureButton,s=void 0===c||c,l=e.loaderButton,h=void 0===l||l,p=e.delayButton,f=void 0===p||p,v=e.facingButton,m=void 0===v||v,y=e.created,g=e.mounted,b=e.captured,B=e.updated,C=e.onError;if(a()(this,t),this.parent=document.body,this.el=document.createElement("div"),this.className="",this.video=document.createElement("video"),this.facingMode=!1,this.delay=0,this.accept="image/*",this.mode="photo",this.ratio=1,this.captureSate=!1,this.isVedeoPlayed=!1,this.captureButton=!0,this.loaderButton=!0,this.delayButton=!0,this.facingButton=!0,"string"==typeof n){var E=document.querySelector(n);this.parent=E||this.parent}else this.parent=n||this.parent;this.facingMode=r||this.facingMode,this.captureButton=s,this.loaderButton=h,this.delayButton=f,this.facingButton=m,this.captured=b,this.onError=C,this.created=y,this.mounted=g,this.updated=B,this.delay=d||0,this.className=o||"camera",this.accept=u||this.accept,this.el.setAttribute("class","mood-camera ".concat(this.className).trim());var k=this.parent.getBoundingClientRect().width,S=this.parent.getBoundingClientRect().height,w=navigator.mediaDevices.getUserMedia({video:{width:{ideal:k},height:{ideal:S},facingMode:{ideal:this.facingMode?"user":"environnement"}}});w.catch((function(t){i.onError&&i.onError(t)})),w.then((function(t){i.created&&i.created(),i.mediaStream=t,window.addEventListener("resize",(function(){return i.build()})),i.parent.addEventListener("resize",(function(){return i.build})),i.el.addEventListener("resize",(function(){return i.build})),i.build()}))}return o()(t,[{key:"buildTrack",value:function(){var t=this,e=this.parent.getBoundingClientRect().width,i=this.parent.getBoundingClientRect().height;this.mediaStream.getVideoTracks()[0].applyConstraints({advanced:[{width:e,height:i*this.ratio,facingMode:{ideal:this.facingMode?"user":"environnement"}}]}),this.video.width=e,this.video.height=i*this.ratio,this.updated&&this.updated(),this.isVedeoPlayed||(this.isVedeoPlayed=!0,this.video.srcObject=this.mediaStream,this.video.onloadedmetadata=function(){t.video.play()})}},{key:"build",value:function(){this.parent.getBoundingClientRect().width,this.parent.getBoundingClientRect().height;this.buildTrack(),this.el.innerHTML="",this.buildCaptureButton(),this.buildButtonLoader(),this.buildButtonFacing(),this.buildDelay(),this.el.appendChild(this.video),this.updated&&this.updated()}},{key:"buildCaptureButton",value:function(){var t=this,e=document.createElement("button");e.setAttribute("class","capture ".concat(this.mode)),e.addEventListener("click",(function(){return t.capture()}));var i=this.el.querySelector("button.capture");this.captureButton?i?i.replaceWith(e):this.el.appendChild(e):null==i||i.remove(),this.updated&&this.updated()}},{key:"buildButtonLoader",value:function(){var t=this,e=document.createElement("button");e.setAttribute("class","loader"),e.addEventListener("click",(function(){return t.load()}));var i=this.el.querySelector("button.loader");this.loaderButton?i?i.replaceWith(e):this.el.appendChild(e):null==i||i.remove(),this.updated&&this.updated()}},{key:"buildButtonFacing",value:function(){var t=this,e=document.createElement("button");e.setAttribute("class","facing"),e.addEventListener("click",(function(){t.facingMode=!t.facingMode,t.buildTrack(),t.buildButtonFacing()}));var i=this.el.querySelector("button.facing");this.facingButton?i?i.replaceWith(e):this.el.appendChild(e):null==i||i.remove(),this.updated&&this.updated()}},{key:"buildDelay",value:function(){var t=this,e=document.createElement("div");e.setAttribute("class","delay");var i=document.createElement("button");if(i.addEventListener("click",(function(){return e.classList.toggle("open")})),i.setAttribute("class","".concat(this.delay?"act":"")),this.delay){var n=document.createElement("span");n.setAttribute("class","delay-span"),n.textContent=String(this.delay),i.appendChild(n)}e.appendChild(i);for(var a=function(){var i=o[r],n=document.createElement("button");n.setAttribute("class","delay-i"),n.textContent=String(i),e.appendChild(n),n.addEventListener("click",(function(){t.delay=i,t.buildDelay()}))},r=0,o=[0,3,5,10];r<o.length;r++)a();var d=this.el.querySelector(".delay");this.delayButton?d?d.replaceWith(e):this.el.appendChild(e):null==d||d.remove(),this.updated&&this.updated()}},{key:"buildDelayIndex",value:function(t){var e=document.createElement("div");e.setAttribute("class","delay-counter"),e.textContent=String(t);var i=this.el.querySelector("div.delay-counter");0===t?null==i||i.remove():i?i.replaceWith(e):this.el.appendChild(e)}},{key:"capture",value:function(){this.captureSate||(this.captureSate=!0,this.delay?this.counter():this.capture0())}},{key:"counter",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.buildDelayIndex(this.delay-e),setTimeout((function(){++e<t.delay?t.counter(e):t.capture0()}),1e3)}},{key:"capture0",value:function(){var t;this.buildDelayIndex(0),this.captureSate=!1;var e=document.createElement("canvas");e.width=this.video.videoWidth,e.height=this.video.videoHeight,document.body.appendChild(e),null===(t=e.getContext("2d"))||void 0===t||t.drawImage(this.video,0,0),document.body.removeChild(e);var i={data:e.toDataURL("image/jpg"),type:"image/jpg",name:"".concat(Date.now(),".jpg")};this.captured&&this.captured(i)}},{key:"mount",value:function(){this.el.parentElement!==this.parent&&(this.parent.appendChild(this.el),this.mounted&&this.mounted())}},{key:"remove",value:function(){this.el.remove(),this.isVedeoPlayed=!1,this.mediaStream.getVideoTracks()[0].stop()}},{key:"load",value:function(){var t=this,e=document.createElement("input");e.setAttribute("type","file"),e.accept=this.accept,e.onchange=function(){if(e.files){var i=e.files[0];if(i){var n=new FileReader;n.onload=function(){var e={name:i.name,size:i.size,type:i.type,data:n.result};t.captured&&t.captured(e)},n.readAsDataURL(i)}}},e.click()}}]),t}()}])}));
//# sourceMappingURL=camera.js.map