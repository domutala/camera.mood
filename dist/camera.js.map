{"version":3,"sources":["webpack://camera/webpack/universalModuleDefinition","webpack://camera/webpack/bootstrap","webpack://camera/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://camera/./node_modules/@babel/runtime/helpers/createClass.js","webpack://camera/./src/camera.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","instance","Constructor","TypeError","_defineProperties","target","props","length","descriptor","configurable","writable","protoProps","staticProps","Camera","parent","facingMode","className","delay","accept","captureButton","loaderButton","delayButton","facingButton","created","mounted","captured","updated","onError","document","body","el","createElement","video","ratio","captureSate","isVedeoPlayed","querySelector","this","setAttribute","trim","width","getBoundingClientRect","height","promise","navigator","mediaDevices","getUserMedia","ideal","e","then","mediaStream","addEventListener","build","getVideoTracks","applyConstraints","advanced","srcObject","onloadedmetadata","play","buildTrack","innerHTML","buildCaptureButton","buildButtonLoader","buildButtonFacing","buildDelay","appendChild","capture","old","replaceWith","remove","btn","load","div","classList","toggle","textContent","String","index","counter","capture0","count","buildDelayIndex","setTimeout","canvas","videoWidth","videoHeight","getContext","drawImage","removeChild","data","toDataURL","type","Date","now","parentElement","stop","input","onchange","files","file","fr","FileReader","onload","size","result","readAsDataURL","click"],"mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,GACe,iBAAZC,QACdA,QAAgB,OAAID,IAEpBD,EAAa,OAAIC,IARnB,CASGK,QAAQ,WACX,O,YCTE,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUP,QAGnC,IAAIC,EAASI,EAAiBE,GAAY,CACzCC,EAAGD,EACHE,GAAG,EACHT,QAAS,IAUV,OANAU,EAAQH,GAAUI,KAAKV,EAAOD,QAASC,EAAQA,EAAOD,QAASM,GAG/DL,EAAOQ,GAAI,EAGJR,EAAOD,QA0Df,OArDAM,EAAoBM,EAAIF,EAGxBJ,EAAoBO,EAAIR,EAGxBC,EAAoBQ,EAAI,SAASd,EAASe,EAAMC,GAC3CV,EAAoBW,EAAEjB,EAASe,IAClCG,OAAOC,eAAenB,EAASe,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEV,EAAoBgB,EAAI,SAAStB,GACX,oBAAXuB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAenB,EAASuB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAenB,EAAS,aAAc,CAAEyB,OAAO,KAQvDnB,EAAoBoB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQnB,EAAoBmB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFAxB,EAAoBgB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOnB,EAAoBQ,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRvB,EAAoB2B,EAAI,SAAShC,GAChC,IAAIe,EAASf,GAAUA,EAAO2B,WAC7B,WAAwB,OAAO3B,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAK,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG7B,EAAoBgC,EAAI,GAIjBhC,EAAoBA,EAAoBiC,EAAI,G,gBC5ErDtC,EAAOD,QANP,SAAyBwC,EAAUC,GACjC,KAAMD,aAAoBC,GACxB,MAAM,IAAIC,UAAU,uC,cCFxB,SAASC,EAAkBC,EAAQC,GACjC,IAAK,IAAIrC,EAAI,EAAGA,EAAIqC,EAAMC,OAAQtC,IAAK,CACrC,IAAIuC,EAAaF,EAAMrC,GACvBuC,EAAW3B,WAAa2B,EAAW3B,aAAc,EACjD2B,EAAWC,cAAe,EACtB,UAAWD,IAAYA,EAAWE,UAAW,GACjD/B,OAAOC,eAAeyB,EAAQG,EAAWhB,IAAKgB,IAUlD9C,EAAOD,QANP,SAAsByC,EAAaS,EAAYC,GAG7C,OAFID,GAAYP,EAAkBF,EAAYL,UAAWc,GACrDC,GAAaR,EAAkBF,EAAaU,GACzCV,I,+GCLIW,EAAb,WA4BE,cA8BC,WA7BCC,EA6BD,EA7BCA,OACAC,EA4BD,EA5BCA,WACAC,EA2BD,EA3BCA,UACAC,EA0BD,EA1BCA,MACAC,EAyBD,EAzBCA,OAyBD,IAxBCC,qBAwBD,aAvBCC,oBAuBD,aAtBCC,mBAsBD,aArBCC,oBAqBD,SApBCC,EAoBD,EApBCA,QACAC,EAmBD,EAnBCA,QACAC,EAkBD,EAlBCA,SACAC,EAiBD,EAjBCA,QACAC,EAgBD,EAhBCA,QAiBA,GADD,YAvDO,KAAAb,OAAkBc,SAASC,KAC3B,KAAAC,GAAKF,SAASG,cAAc,OAC5B,KAAAf,UAAoB,GAEpB,KAAAgB,MAAQJ,SAASG,cAAc,SAC/B,KAAAhB,YAAsB,EACtB,KAAAE,MAAgB,EAChB,KAAAC,OAAiB,UACjB,KAAA9B,KAA0B,QAC1B,KAAA6C,MAAgB,EAEhB,KAAAC,aAAuB,EACvB,KAAAC,eAAyB,EAEzB,KAAAhB,eAAgB,EAChB,KAAAC,cAAe,EACf,KAAAC,aAAc,EACd,KAAAC,cAAe,EAuCC,iBAAXR,EAAqB,CAC9B,IAAMf,EAAI6B,SAASQ,cAActB,GACjCuB,KAAKvB,OAASf,GAAKsC,KAAKvB,YAExBuB,KAAKvB,OAASA,GAAUuB,KAAKvB,OAG/BuB,KAAKtB,WAAaA,GAAcsB,KAAKtB,WACrCsB,KAAKlB,cAAgBA,EACrBkB,KAAKjB,aAAeA,EACpBiB,KAAKhB,YAAcA,EACnBgB,KAAKf,aAAeA,EAEpBe,KAAKZ,SAAWA,EAChBY,KAAKV,QAAUA,EACfU,KAAKd,QAAUA,EACfc,KAAKb,QAAUA,EACfa,KAAKX,QAAUA,EAEfW,KAAKpB,MAAQA,GAAS,EACtBoB,KAAKrB,UAAYA,GAAa,SAC9BqB,KAAKnB,OAASA,GAAUmB,KAAKnB,OAE7BmB,KAAKP,GAAGQ,aAAa,QAAS,sBAAeD,KAAKrB,WAAYuB,QAE9D,IAAMC,EAAQH,KAAKvB,OAAO2B,wBAAwBD,MAC5CE,EAASL,KAAKvB,OAAO2B,wBAAwBC,OAE7CC,EAAUC,UAAUC,aAAaC,aAAa,CAClDd,MAAO,CACLQ,MAAO,CAAEO,MAAOP,GAChBE,OAAQ,CAAEK,MAAOL,GACjB3B,WAAY,CACVgC,MAAOV,KAAKtB,WAAa,OAAS,oBAKxC4B,EAAO,OAAO,SAAAK,GACR,EAAKrB,SACP,EAAKA,QAAQqB,MAIjBL,EAAQM,MAAK,SAAAC,GACP,EAAK3B,SACP,EAAKA,UAEP,EAAK2B,YAAcA,EAEnBrF,OAAOsF,iBAAiB,UAAU,kBAAM,EAAKC,WAC7C,EAAKtC,OAAOqC,iBAAiB,UAAU,kBAAM,EAAKC,SAClD,EAAKtB,GAAGqB,iBAAiB,UAAU,kBAAM,EAAKC,SAE9C,EAAKA,WAjHX,iDAqHY,WACFZ,EAAQH,KAAKvB,OAAO2B,wBAAwBD,MAC5CE,EAASL,KAAKvB,OAAO2B,wBAAwBC,OACrCL,KAAKa,YAAYG,iBAAiB,GAC1CC,iBAAiB,CACrBC,SAAU,CACR,CACEf,QACAE,OAAQA,EAASL,KAAKJ,MACtBlB,WAAY,CACVgC,MAAOV,KAAKtB,WAAa,OAAS,qBAM1CsB,KAAKL,MAAMQ,MAAQA,EACnBH,KAAKL,MAAMU,OAASA,EAASL,KAAKJ,MAE9BI,KAAKX,SACPW,KAAKX,UAGFW,KAAKF,gBACRE,KAAKF,eAAgB,EACrBE,KAAKL,MAAMwB,UAAYnB,KAAKa,YAC5Bb,KAAKL,MAAMyB,iBAAmB,WAC5B,EAAKzB,MAAM0B,WAhJnB,8BAsJkBrB,KAAKvB,OAAO2B,wBAAwBD,MACnCH,KAAKvB,OAAO2B,wBAAwBC,OAEnDL,KAAKsB,aACLtB,KAAKP,GAAG8B,UAAY,GAEpBvB,KAAKwB,qBACLxB,KAAKyB,oBACLzB,KAAK0B,oBACL1B,KAAK2B,aAEL3B,KAAKP,GAAGmC,YAAY5B,KAAKL,OAErBK,KAAKX,SACPW,KAAKX,YApKX,2CAwK4B,WAClBwC,EAAUtC,SAASG,cAAc,UACvCmC,EAAQ5B,aAAa,QAArB,kBAAyCD,KAAKjD,OAC9C8E,EAAQf,iBAAiB,SAAS,kBAAM,EAAKe,aAE7C,IAAMC,EAAM9B,KAAKP,GAAGM,cAAc,kBAE9BC,KAAKlB,cACPgD,EAAMA,EAAIC,YAAYF,GAAW7B,KAAKP,GAAGmC,YAAYC,GAErDC,WAAKE,SAGHhC,KAAKX,SACPW,KAAKX,YAtLX,0CAyL2B,WACjB4C,EAAM1C,SAASG,cAAc,UACnCuC,EAAIhC,aAAa,QAAjB,UACAgC,EAAInB,iBAAiB,SAAS,kBAAM,EAAKoB,UACzC,IAAMJ,EAAM9B,KAAKP,GAAGM,cAAc,iBAE9BC,KAAKjB,aACP+C,EAAMA,EAAIC,YAAYE,GAAOjC,KAAKP,GAAGmC,YAAYK,GAEjDH,WAAKE,SAGHhC,KAAKX,SACPW,KAAKX,YAtMX,0CAyM2B,WACjB4C,EAAM1C,SAASG,cAAc,UACnCuC,EAAIhC,aAAa,QAAjB,UACAgC,EAAInB,iBAAiB,SAAS,WAC5B,EAAKpC,YAAc,EAAKA,WACxB,EAAK4C,aACL,EAAKI,uBAGP,IAAMI,EAAM9B,KAAKP,GAAGM,cAAc,iBAC9BC,KAAKf,aACP6C,EAAMA,EAAIC,YAAYE,GAAOjC,KAAKP,GAAGmC,YAAYK,GAEjDH,WAAKE,SAGHhC,KAAKX,SACPW,KAAKX,YA1NX,mCA6NoB,WACV8C,EAAM5C,SAASG,cAAc,OACnCyC,EAAIlC,aAAa,QAAjB,SAEA,IAAMU,EAAIpB,SAASG,cAAc,UAIjC,GAHAiB,EAAEG,iBAAiB,SAAS,kBAAMqB,EAAIC,UAAUC,OAAO,WACvD1B,EAAEV,aAAa,QAAf,UAA2BD,KAAKpB,MAAQ,MAAQ,KAE5CoB,KAAKpB,MAAO,CACd,IAAMjB,EAAI4B,SAASG,cAAc,QACjC/B,EAAEsC,aAAa,QAAf,cACAtC,EAAE2E,YAAcC,OAAOvC,KAAKpB,OAC5B+B,EAAEiB,YAAYjE,GAGhBwE,EAAIP,YAAYjB,GAGhB,IADA,IAjBgB,aAkBX,IAAI/E,EAAC,KACF+E,EAAIpB,SAASG,cAAc,UACjCiB,EAAEV,aAAa,QAAS,WACxBU,EAAE2B,YAAcC,OAAO3G,GACvBuG,EAAIP,YAAYjB,GAChBA,EAAEG,iBAAiB,SAAS,WAC1B,EAAKlC,MAAQhD,EACb,EAAK+F,iBAPT,MAAc,CAAC,EAAG,EAAG,EAAG,IAAxB,eAA6B,IAa7B,IAAMG,EAAM9B,KAAKP,GAAGM,cAAc,UAE9BC,KAAKhB,YACP8C,EAAMA,EAAIC,YAAYI,GAAOnC,KAAKP,GAAGmC,YAAYO,GAEjDL,WAAKE,SAGHhC,KAAKX,SACPW,KAAKX,YArQX,sCAwQ0BmD,GACtB,IAAM5G,EAAI2D,SAASG,cAAc,OACjC9D,EAAEqE,aAAa,QAAf,iBACArE,EAAE0G,YAAcC,OAAOC,GACvB,IAAMV,EAAM9B,KAAKP,GAAGM,cAAc,qBAEpB,IAAVyC,EACFV,WAAKE,SAELF,EAAMA,EAAIC,YAAYnG,GAAKoE,KAAKP,GAAGmC,YAAYhG,KAjRrD,gCAsRSoE,KAAKH,cACRG,KAAKH,aAAc,EACnBG,KAAKpB,MAAQoB,KAAKyC,UAAYzC,KAAK0C,cAxRzC,gCA4R2B,WAATC,EAAS,uDAAD,EACtB3C,KAAK4C,gBAAgB5C,KAAKpB,MAAQ+D,GAClCE,YAAW,aACTF,EACQ,EAAK/D,MAAQ,EAAK6D,QAAQE,GAAS,EAAKD,aAC/C,OAjSP,iCAoSkB,MACd1C,KAAK4C,gBAAgB,GACrB5C,KAAKH,aAAc,EACnB,IAAMiD,EAASvD,SAASG,cAAc,UACtCoD,EAAO3C,MAAQH,KAAKL,MAAMoD,WAC1BD,EAAOzC,OAASL,KAAKL,MAAMqD,YAE3BzD,SAASC,KAAKoC,YAAYkB,GAC1B,UAAAA,EAAOG,WAAW,aAAlB,SAAyBC,UAAUlD,KAAKL,MAAO,EAAG,GAClDJ,SAASC,KAAK2D,YAAYL,GAE1B,IAAMxF,EAAS,CACb8F,KAAMN,EAAOO,UAAU,aACvBC,KAAM,YACNnH,KAAM,GAAF,OAAKoH,KAAKC,MAAV,SAGFxD,KAAKZ,UACPY,KAAKZ,SAAS9B,KAtTpB,8BA2TQ0C,KAAKP,GAAGgE,gBAAkBzD,KAAKvB,SACjCuB,KAAKvB,OAAOmD,YAAY5B,KAAKP,IACzBO,KAAKb,SACPa,KAAKb,aA9Tb,+BAoUIa,KAAKP,GAAGuC,SACRhC,KAAKF,eAAgB,EAEPE,KAAKa,YAAYG,iBAAiB,GAC1C0C,SAxUV,6BA2UM,WACIC,EAAQpE,SAASG,cAAc,SACrCiE,EAAM1D,aAAa,OAAQ,QAC3B0D,EAAM9E,OAASmB,KAAKnB,OAEpB8E,EAAMC,SAAW,WACf,GAAID,EAAME,MAAO,CACf,IAAMC,EAAOH,EAAME,MAAM,GAEzB,GAAIC,EAAM,CACR,IAAMC,EAAK,IAAIC,WACfD,EAAGE,OAAS,WACV,IAAM3G,EAAS,CACbnB,KAAM2H,EAAK3H,KACX+H,KAAMJ,EAAKI,KACXZ,KAAMQ,EAAKR,KACXF,KAAMW,EAAGI,QAGP,EAAK/E,UACP,EAAKA,SAAS9B,IAGlByG,EAAGK,cAAcN,MAKvBH,EAAMU,YAvWV","file":"camera.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"camera\"] = factory();\n\telse\n\t\troot[\"camera\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","// domutalla\r\n\r\ninterface CameraObject {\r\n  data: string;\r\n  type: string;\r\n  name: string;\r\n}\r\n\r\nexport class Camera {\r\n  private mediaStream!: MediaStream;\r\n\r\n  private parent: Element = document.body;\r\n  private el = document.createElement('div');\r\n  private className: string = '';\r\n\r\n  private video = document.createElement('video');\r\n  private facingMode: boolean = false;\r\n  private delay: number = 0;\r\n  private accept: string = 'image/*';\r\n  private mode: 'video' | 'photo' = 'photo';\r\n  private ratio: number = 1;\r\n\r\n  private captureSate: boolean = false;\r\n  private isVedeoPlayed: boolean = false;\r\n\r\n  private captureButton = true;\r\n  private loaderButton = true;\r\n  private delayButton = true;\r\n  private facingButton = true;\r\n\r\n  private captured?: (data: CameraObject) => void;\r\n  private onError?: (data?: any) => void;\r\n  private created?: () => void;\r\n  private mounted?: () => void;\r\n  private updated?: () => void;\r\n\r\n  constructor({\r\n    parent,\r\n    facingMode,\r\n    className,\r\n    delay,\r\n    accept,\r\n    captureButton = true,\r\n    loaderButton = true,\r\n    delayButton = true,\r\n    facingButton = true,\r\n    created,\r\n    mounted,\r\n    captured,\r\n    updated,\r\n    onError\r\n  }: {\r\n    parent?: Element | string;\r\n    facingMode?: boolean;\r\n    className?: string;\r\n    delay?: number;\r\n    accept?: string;\r\n    captureButton?: boolean;\r\n    loaderButton?: boolean;\r\n    delayButton?: boolean;\r\n    facingButton?: boolean;\r\n    created?: () => void;\r\n    mounted?: () => void;\r\n    updated?: () => void;\r\n    captured?: (data: CameraObject) => void;\r\n    onError?: (data?: any) => void;\r\n  }) {\r\n    if (typeof parent === 'string') {\r\n      const p = document.querySelector(parent);\r\n      this.parent = p || this.parent;\r\n    } else {\r\n      this.parent = parent || this.parent;\r\n    }\r\n\r\n    this.facingMode = facingMode || this.facingMode;\r\n    this.captureButton = captureButton;\r\n    this.loaderButton = loaderButton;\r\n    this.delayButton = delayButton;\r\n    this.facingButton = facingButton;\r\n\r\n    this.captured = captured;\r\n    this.onError = onError;\r\n    this.created = created;\r\n    this.mounted = mounted;\r\n    this.updated = updated;\r\n\r\n    this.delay = delay || 0;\r\n    this.className = className || 'camera';\r\n    this.accept = accept || this.accept;\r\n\r\n    this.el.setAttribute('class', `mood-camera ${this.className}`.trim());\r\n\r\n    const width = this.parent.getBoundingClientRect().width;\r\n    const height = this.parent.getBoundingClientRect().height;\r\n\r\n    const promise = navigator.mediaDevices.getUserMedia({\r\n      video: {\r\n        width: { ideal: width },\r\n        height: { ideal: height },\r\n        facingMode: {\r\n          ideal: this.facingMode ? 'user' : 'environnement'\r\n        }\r\n      }\r\n    });\r\n\r\n    promise.catch(e => {\r\n      if (this.onError) {\r\n        this.onError(e);\r\n      }\r\n    });\r\n\r\n    promise.then(mediaStream => {\r\n      if (this.created) {\r\n        this.created();\r\n      }\r\n      this.mediaStream = mediaStream;\r\n\r\n      window.addEventListener('resize', () => this.build());\r\n      this.parent.addEventListener('resize', () => this.build);\r\n      this.el.addEventListener('resize', () => this.build);\r\n\r\n      this.build();\r\n    });\r\n  }\r\n\r\n  buildTrack() {\r\n    const width = this.parent.getBoundingClientRect().width;\r\n    const height = this.parent.getBoundingClientRect().height;\r\n    const track = this.mediaStream.getVideoTracks()[0];\r\n    track.applyConstraints({\r\n      advanced: [\r\n        {\r\n          width,\r\n          height: height * this.ratio,\r\n          facingMode: {\r\n            ideal: this.facingMode ? 'user' : 'environnement'\r\n          }\r\n        }\r\n      ]\r\n    });\r\n\r\n    this.video.width = width;\r\n    this.video.height = height * this.ratio;\r\n\r\n    if (this.updated) {\r\n      this.updated();\r\n    }\r\n\r\n    if (!this.isVedeoPlayed) {\r\n      this.isVedeoPlayed = true;\r\n      this.video.srcObject = this.mediaStream;\r\n      this.video.onloadedmetadata = () => {\r\n        this.video.play();\r\n      };\r\n    }\r\n  }\r\n\r\n  build() {\r\n    const width = this.parent.getBoundingClientRect().width;\r\n    const height = this.parent.getBoundingClientRect().height;\r\n\r\n    this.buildTrack();\r\n    this.el.innerHTML = '';\r\n\r\n    this.buildCaptureButton();\r\n    this.buildButtonLoader();\r\n    this.buildButtonFacing();\r\n    this.buildDelay();\r\n\r\n    this.el.appendChild(this.video);\r\n\r\n    if (this.updated) {\r\n      this.updated();\r\n    }\r\n  }\r\n\r\n  private buildCaptureButton() {\r\n    const capture = document.createElement('button');\r\n    capture.setAttribute('class', `capture ${this.mode}`);\r\n    capture.addEventListener('click', () => this.capture());\r\n\r\n    const old = this.el.querySelector('button.capture');\r\n\r\n    if (this.captureButton) {\r\n      old ? old.replaceWith(capture) : this.el.appendChild(capture);\r\n    } else {\r\n      old?.remove();\r\n    }\r\n\r\n    if (this.updated) {\r\n      this.updated();\r\n    }\r\n  }\r\n  private buildButtonLoader() {\r\n    const btn = document.createElement('button');\r\n    btn.setAttribute('class', `loader`);\r\n    btn.addEventListener('click', () => this.load());\r\n    const old = this.el.querySelector('button.loader');\r\n\r\n    if (this.loaderButton) {\r\n      old ? old.replaceWith(btn) : this.el.appendChild(btn);\r\n    } else {\r\n      old?.remove();\r\n    }\r\n\r\n    if (this.updated) {\r\n      this.updated();\r\n    }\r\n  }\r\n  private buildButtonFacing() {\r\n    const btn = document.createElement('button');\r\n    btn.setAttribute('class', `facing`);\r\n    btn.addEventListener('click', () => {\r\n      this.facingMode = !this.facingMode;\r\n      this.buildTrack();\r\n      this.buildButtonFacing();\r\n    });\r\n\r\n    const old = this.el.querySelector('button.facing');\r\n    if (this.facingButton) {\r\n      old ? old.replaceWith(btn) : this.el.appendChild(btn);\r\n    } else {\r\n      old?.remove();\r\n    }\r\n\r\n    if (this.updated) {\r\n      this.updated();\r\n    }\r\n  }\r\n  private buildDelay() {\r\n    const div = document.createElement('div');\r\n    div.setAttribute('class', `delay`);\r\n\r\n    const e = document.createElement('button');\r\n    e.addEventListener('click', () => div.classList.toggle('open'));\r\n    e.setAttribute('class', `${this.delay ? 'act' : ''}`);\r\n\r\n    if (this.delay) {\r\n      const s = document.createElement('span');\r\n      s.setAttribute('class', `delay-span`);\r\n      s.textContent = String(this.delay);\r\n      e.appendChild(s);\r\n    }\r\n\r\n    div.appendChild(e);\r\n\r\n    let d = 0;\r\n    for (let i of [0, 3, 5, 10]) {\r\n      const e = document.createElement('button');\r\n      e.setAttribute('class', 'delay-i');\r\n      e.textContent = String(i);\r\n      div.appendChild(e);\r\n      e.addEventListener('click', () => {\r\n        this.delay = i;\r\n        this.buildDelay();\r\n      });\r\n      // e.style.animationDelay = `${d * 0.5}s`;\r\n      d++;\r\n    }\r\n\r\n    const old = this.el.querySelector('.delay');\r\n\r\n    if (this.delayButton) {\r\n      old ? old.replaceWith(div) : this.el.appendChild(div);\r\n    } else {\r\n      old?.remove();\r\n    }\r\n\r\n    if (this.updated) {\r\n      this.updated();\r\n    }\r\n  }\r\n  private buildDelayIndex(index: number) {\r\n    const i = document.createElement('div');\r\n    i.setAttribute('class', `delay-counter`);\r\n    i.textContent = String(index);\r\n    const old = this.el.querySelector('div.delay-counter');\r\n\r\n    if (index === 0) {\r\n      old?.remove();\r\n    } else {\r\n      old ? old.replaceWith(i) : this.el.appendChild(i);\r\n    }\r\n  }\r\n\r\n  capture() {\r\n    if (!this.captureSate) {\r\n      this.captureSate = true;\r\n      this.delay ? this.counter() : this.capture0();\r\n    }\r\n  }\r\n\r\n  private counter(count = 0) {\r\n    this.buildDelayIndex(this.delay - count);\r\n    setTimeout(() => {\r\n      count++;\r\n      count < this.delay ? this.counter(count) : this.capture0();\r\n    }, 1000);\r\n  }\r\n\r\n  private capture0() {\r\n    this.buildDelayIndex(0);\r\n    this.captureSate = false;\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = this.video.videoWidth;\r\n    canvas.height = this.video.videoHeight;\r\n\r\n    document.body.appendChild(canvas);\r\n    canvas.getContext('2d')?.drawImage(this.video, 0, 0);\r\n    document.body.removeChild(canvas);\r\n\r\n    const object = {\r\n      data: canvas.toDataURL('image/jpg'),\r\n      type: 'image/jpg',\r\n      name: `${Date.now()}.jpg`\r\n    };\r\n\r\n    if (this.captured) {\r\n      this.captured(object);\r\n    }\r\n  }\r\n\r\n  mount() {\r\n    if (this.el.parentElement !== this.parent) {\r\n      this.parent.appendChild(this.el);\r\n      if (this.mounted) {\r\n        this.mounted();\r\n      }\r\n    }\r\n  }\r\n\r\n  remove() {\r\n    this.el.remove();\r\n    this.isVedeoPlayed = false;\r\n\r\n    const track = this.mediaStream.getVideoTracks()[0];\r\n    track.stop();\r\n  }\r\n\r\n  load() {\r\n    const input = document.createElement('input');\r\n    input.setAttribute('type', 'file');\r\n    input.accept = this.accept;\r\n\r\n    input.onchange = () => {\r\n      if (input.files) {\r\n        const file = input.files[0];\r\n\r\n        if (file) {\r\n          const fr = new FileReader();\r\n          fr.onload = () => {\r\n            const object = {\r\n              name: file.name,\r\n              size: file.size,\r\n              type: file.type,\r\n              data: fr.result as string\r\n            };\r\n\r\n            if (this.captured) {\r\n              this.captured(object);\r\n            }\r\n          };\r\n          fr.readAsDataURL(file);\r\n        }\r\n      }\r\n    };\r\n\r\n    input.click();\r\n  }\r\n}\r\n"],"sourceRoot":""}